#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f linscript -o linbinary 
#endif

static  char data [] = 
#define      chk1_z	22
#define      chk1	((&data[4]))
	"\221\131\163\300\340\137\015\333\072\023\140\273\333\155\317\265"
	"\222\106\154\010\176\334\177\036\152\374\204"
#define      xecc_z	15
#define      xecc	((&data[30]))
	"\241\020\014\045\205\372\055\332\307\373\236\326\177\331\253\031"
	"\075\205\137"
#define      opts_z	1
#define      opts	((&data[46]))
	"\277"
#define      text_z	5046
#define      text	((&data[1039]))
	"\145\202\315\177\136\253\023\256\357\354\067\251\070\310\003\253"
	"\211\210\007\200\332\250\220\347\007\114\223\034\022\134\214\170"
	"\337\132\367\075\005\013\354\364\370\043\236\060\354\242\334\166"
	"\052\343\366\005\213\206\354\223\323\200\260\346\335\074\137\274"
	"\227\126\372\234\142\346\221\133\011\060\213\366\322\147\154\375"
	"\113\142\002\327\351\357\153\274\157\033\242\114\130\002\011\357"
	"\130\003\214\273\351\035\026\363\116\242\351\040\012\126\035\125"
	"\271\040\055\242\017\230\136\177\263\001\314\014\003\325\374\134"
	"\330\210\030\302\246\056\265\364\321\237\025\333\365\063\061\256"
	"\123\136\120\143\366\257\342\252\261\257\266\265\204\262\022\135"
	"\073\052\037\341\131\324\326\052\163\353\006\151\037\067\027\162"
	"\225\150\326\213\027\271\065\311\150\354\176\354\237\220\111\332"
	"\273\151\274\025\075\222\077\261\176\105\032\235\174\061\020\022"
	"\232\346\235\261\237\323\172\010\277\371\365\136\212\077\071\105"
	"\250\365\132\346\207\232\227\005\340\261\243\135\343\263\157\176"
	"\231\014\057\071\340\252\102\237\244\067\376\056\167\067\164\037"
	"\055\316\005\265\151\235\273\111\117\136\246\063\021\025\261\253"
	"\042\341\345\002\213\047\242\060\137\241\136\326\331\322\366\006"
	"\241\373\273\013\231\166\124\350\324\373\033\346\021\314\221\063"
	"\255\166\066\071\236\330\151\375\171\310\324\122\233\312\130\074"
	"\306\024\110\137\212\234\107\137\230\142\105\251\057\326\335\334"
	"\115\023\026\353\353\177\351\145\107\276\270\342\210\020\037\116"
	"\045\147\256\260\004\365\017\235\130\124\106\207\053\043\144\171"
	"\066\172\145\042\372\117\207\101\015\077\044\225\120\103\344\165"
	"\253\222\046\260\210\065\115\341\212\223\150\266\267\315\057\356"
	"\110\225\020\102\344\230\204\362\327\250\207\050\354\154\236\227"
	"\377\304\110\207\372\225\151\204\051\322\072\341\237\152\317\347"
	"\000\337\052\344\167\256\326\117\126\136\170\103\313\027\333\312"
	"\333\043\122\325\271\273\132\342\215\225\303\054\377\222\024\377"
	"\162\076\344\352\355\273\072\103\032\262\207\345\311\142\260\245"
	"\205\002\173\076\276\325\041\113\152\344\170\152\167\215\152\352"
	"\314\117\324\271\013\016\375\045\301\204\013\213\346\273\060\153"
	"\276\253\252\174\201\313\310\353\260\100\126\047\316\300\022\232"
	"\017\346\123\032\365\121\100\267\325\114\102\274\007\163\047\306"
	"\037\322\103\240\235\013\214\116\114\342\166\032\242\210\265\262"
	"\157\010\315\144\131\015\034\057\131\136\353\141\322\023\050\361"
	"\346\153\222\203\167\036\322\304\000\110\336\243\320\223\126\077"
	"\234\043\244\366\061\301\046\212\040\021\354\362\045\024\343\013"
	"\200\166\217\370\224\141\274\225\252\233\071\172\057\217\272\313"
	"\262\137\302\344\040\350\157\100\372\133\063\040\160\027\054\361"
	"\215\273\351\041\035\245\267\307\100\360\102\157\177\375\073\062"
	"\134\376\026\175\347\205\276\342\341\361\002\121\010\056\102\225"
	"\352\054\267\007\321\156\316\022\136\020\202\336\016\275\020\152"
	"\273\047\350\242\254\246\204\215\230\207\337\241\265\042\067\237"
	"\116\356\247\040\135\165\062\274\206\264\232\224\162\253\377\055"
	"\322\350\320\176\217\125\014\047\334\354\310\222\016\377\062\134"
	"\356\331\174\113\116\257\007\325\143\242\152\325\115\152\003\040"
	"\122\324\237\341\051\253\011\005\227\321\230\246\320\312\002\277"
	"\243\177\012\362\057\022\310\222\264\062\150\002\235\154\042\357"
	"\100\302\321\151\155\332\157\005\254\010\253\174\322\256\074\165"
	"\056\106\150\135\131\060\360\016\143\131\020\000\305\063\360\005"
	"\365\301\157\143\234\337\151\110\347\025\304\271\303\000\057\362"
	"\107\227\120\240\307\100\256\052\231\277\053\137\363\033\144\351"
	"\334\324\115\170\263\266\300\232\313\205\124\217\206\203\202\316"
	"\033\322\157\343\022\036\016\254\335\071\013\321\124\157\272\061"
	"\104\007\252\367\276\153\222\211\361\347\031\167\153\233\106\207"
	"\155\265\152\200\323\170\054\261\262\067\202\007\247\075\071\353"
	"\104\343\343\003\117\166\214\100\136\246\267\311\101\376\120\257"
	"\263\273\057\206\064\133\070\346\223\272\356\072\367\047\046\074"
	"\013\012\077\132\201\314\232\337\162\122\250\264\120\371\143\004"
	"\264\223\213\350\357\303\317\202\175\275\275\165\345\344\262\360"
	"\356\361\113\157\276\346\116\061\070\367\345\211\361\111\216\246"
	"\340\004\323\156\134\071\136\270\271\341\261\041\373\146\057\347"
	"\132\115\231\152\156\050\352\146\112\230\167\340\236\276\252\131"
	"\234\221\041\166\340\171\207\011\120\365\057\144\036\066\346\354"
	"\127\304\034\027\206\330\345\214\264\235\140\054\057\125\153\026"
	"\111\106\337\033\125\247\204\202\066\315\204\232\035\253\144\156"
	"\176\056\134\342\011\325\052\036\264\011\062\312\236\332\145\247"
	"\112\163\347\167\076\236\021\074\313\252\024\225\164\255\050\016"
	"\257\263\010\152\072\202\152\331\001\023\142\324\263\173\344\150"
	"\330\201\103\245\033\320\064\377\316\054\165\121\003\127\116\066"
	"\271\045\362\366\312\361\007\165\303\151\363\273\244\353\267\236"
	"\300\007\363\214\050\134\152\055\124\333\266\216\261\201\006\136"
	"\272\101\301\315\134\377\361\311\070\263\107\357\120\050\243\354"
	"\255\037\025\220\311\221\372\275\155\314\334\140\226\172\121\216"
	"\040\242\355\340\030\114\245\217\266\335\006\121\101\354\114\010"
	"\060\334\322\303\237\046\072\344\154\230\122\311\307\061\313\263"
	"\375\017\136\134\130\075\110\215\233\175\014\105\035\041\100\105"
	"\345\241\121\136\365\020\265\053\165\055\210\054\102\224\012\235"
	"\104\324\362\072\250\143\157\066\373\074\127\053\263\026\343\275"
	"\046\147\074\023\330\134\036\175\116\165\125\330\112\027\337\166"
	"\007\006\264\102\312\016\163\347\362\117\171\115\306\307\220\314"
	"\017\042\234\357\352\300\030\355\105\101\213\204\303\277\305\044"
	"\266\071\154\205\054\016\104\253\115\325\156\206\244\110\101\175"
	"\233\141\005\204\145\231\057\272\322\132\110\376\065\047\371\246"
	"\154\115\224\316\167\306\105\006\312\243\036\256\103\336\106\035"
	"\043\013\334\242\250\122\300\334\224\340\163\027\077\166\340\052"
	"\373\225\125\015\021\130\204\104\360\117\015\002\266\044\203\334"
	"\360\246\044\215\100\036\266\007\330\266\106\223\160\267\047\232"
	"\344\000\343\066\134\040\204\111\002\326\221\273\343\066\342\320"
	"\141\225\016\020\173\263\133\344\276\254\370\335\160\014\143\267"
	"\052\021\237\310\257\307\366\313\253\200\042\000\017\315\137\333"
	"\003\063\073\200\035\216\277\203\103\114\314\177\017\241\062\173"
	"\234\364\250\354\135\074\113\307\277\360\223\370\047\031\175\074"
	"\063\020\247\175\014\030\151\214\224\307\366\356\253\257\145\252"
	"\106\201\157\146\324\004\321\077\122\115\370\311\261\327\067\255"
	"\012\152\004\041\175\335\326\323\011\324\253\367\142\362\026\074"
	"\053\364\220\325\057\334\023\120\231\352\042\155\247\030\000\005"
	"\241\025\007\307\246\310\270\137\050\337\262\201\203\033\353\154"
	"\272\232\202\233\372\311\273\150\366\073\345\330\226\077\127\250"
	"\242\375\367\152\375\232\131\150\265\033\067\230\016\047\170\300"
	"\222\071\216\064\204\254\357\255\203\305\201\325\240\341\217\214"
	"\037\354\155\100\326\275\341\023\137\106\264\247\002\353\071\022"
	"\241\377\114\136\026\350\255\155\004\265\207\230\355\336\255\261"
	"\220\123\334\212\171\144\173\342\277\334\263\306\354\315\156\364"
	"\121\125\002\070\167\112\274\205\120\377\275\323\036\210\154\076"
	"\200\263\250\133\210\102\372\216\333\370\260\041\246\154\240\365"
	"\365\216\071\116\003\274\336\301\214\323\354\100\264\113\127\140"
	"\002\115\075\306\023\061\162\313\002\020\031\246\304\163\023\347"
	"\120\246\232\054\256\167\231\217\203\254\013\136\300\011\127\236"
	"\005\361\042\261\375\043\101\305\112\063\207\253\172\056\161\331"
	"\113\305\233\307\335\256\157\255\202\047\244\171\077\051\017\116"
	"\213\375\323\260\174\156\051\263\366\372\226\215\106\243\137\211"
	"\376\145\311\003\013\357\213\000\236\064\163\134\010\011\044\266"
	"\076\277\225\034\134\257\362\211\065\363\034\066\145\224\272\315"
	"\243\125\174\266\042\164\334\070\203\371\003\131\274\071\332\150"
	"\140\331\011\005\231\026\317\160\377\113\122\100\307\160\163\036"
	"\143\160\323\370\262\042\310\012\044\244\377\153\330\157\100\131"
	"\176\263\076\171\142\320\355\244\065\112\322\345\256\113\234\062"
	"\000\261\140\234\052\235\016\123\003\241\045\264\264\157\053\040"
	"\033\324\043\277\324\347\011\337\267\131\310\057\212\023\356\224"
	"\376\145\335\241\103\210\045\245\214\253\075\164\144\076\156\222"
	"\032\256\205\267\010\326\373\212\007\321\267\106\217\120\163\161"
	"\323\111\064\326\173\020\273\377\351\234\223\051\067\316\046\035"
	"\075\370\212\212\025\312\055\125\363\307\316\256\156\005\122\323"
	"\377\362\162\120\174\336\202\217\200\177\034\124\251\342\140\014"
	"\205\334\126\351\177\154\051\172\047\014\107\102\217\254\320\222"
	"\120\037\365\350\310\261\233\330\131\237\237\352\176\210\153\006"
	"\074\305\045\274\213\100\057\016\104\053\321\257\217\004\230\067"
	"\022\154\330\245\270\373\112\371\217\355\055\362\361\164\211\311"
	"\342\365\236\043\253\051\036\370\333\215\045\341\100\260\162\067"
	"\336\055\303\035\204\275\200\374\263\214\061\032\213\000\171\306"
	"\064\121\156\207\013\112\052\225\375\075\060\307\027\016\342\253"
	"\343\207\346\311\354\377\163\177\072\321\243\350\131\331\323\130"
	"\200\145\176\154\147\304\040\343\075\025\062\110\204\016\004\300"
	"\023\115\163\206\116\221\304\304\225\245\312\023\051\312\375\012"
	"\352\315\304\340\120\250\071\244\175\104\164\023\243\255\231\116"
	"\302\177\035\305\107\011\124\342\162\270\157\226\375\262\337\040"
	"\300\335\077\256\061\321\121\011\115\171\123\326\111\342\306\047"
	"\244\233\277\073\152\366\337\067\101\321\116\215\143\127\035\370"
	"\216\201\263\262\021\306\120\332\337\225\115\215\313\226\065\115"
	"\176\327\202\333\225\156\246\133\153\061\177\210\333\377\355\250"
	"\322\355\322\000\010\327\075\166\026\151\215\263\133\265\376\063"
	"\133\262\022\201\176\167\005\174\147\355\273\243\057\204\346\271"
	"\140\172\272\132\262\143\357\140\026\204\272\323\047\361\252\336"
	"\011\232\244\170\232\040\316\137\367\112\055\132\341\262\254\311"
	"\010\102\270\336\140\302\012\224\102\316\136\163\053\153\374\122"
	"\225\063\077\021\147\261\156\116\157\115\025\176\135\173\135\053"
	"\301\030\350\300\305\157\015\344\217\171\263\313\005\113\261\372"
	"\245\302\203\227\365\205\213\207\340\375\141\122\067\223\332\301"
	"\064\104\235\043\216\330\002\172\154\001\236\277\224\256\250\023"
	"\245\277\077\262\074\360\352\006\314\021\122\040\264\311\371\332"
	"\212\321\271\023\267\013\254\045\036\136\054\305\374\332\313\257"
	"\043\370\316\010\214\153\224\027\157\237\245\370\020\327\203\360"
	"\324\240\135\106\202\162\122\112\320\217\306\365\304\331\215\361"
	"\014\226\152\215\034\306\242\017\031\340\056\224\321\336\320\024"
	"\056\313\130\152\340\070\167\330\312\215\104\016\114\167\077\132"
	"\172\107\367\156\342\221\204\327\335\153\112\051\111\350\341\164"
	"\224\002\046\147\000\035\327\371\161\216\375\060\040\256\103\304"
	"\302\325\163\371\254\034\113\117\063\240\354\057\111\001\004\144"
	"\317\345\320\040\357\350\236\104\377\024\120\160\355\244\244\023"
	"\001\241\311\363\357\030\354\067\212\372\254\312\362\162\076\213"
	"\043\150\011\336\235\224\333\155\066\131\057\073\201\261\305\325"
	"\006\053\142\021\312\050\162\321\112\263\177\165\016\202\274\173"
	"\240\176\317\167\064\372\245\301\307\014\043\265\103\337\123\354"
	"\144\110\150\153\240\356\337\107\201\170\342\175\227\275\222\352"
	"\270\356\062\166\173\015\170\004\275\117\313\130\313\340\361\345"
	"\004\306\056\345\331\145\360\305\052\163\236\316\126\321\245\053"
	"\244\104\366\324\351\204\371\215\143\336\311\301\244\232\174\032"
	"\256\310\237\034\011\070\203\142\156\251\316\234\363\162\173\134"
	"\305\236\134\141\265\317\252\007\075\157\023\131\224\040\120\371"
	"\161\326\032\111\114\222\044\302\245\050\114\070\052\255\255\353"
	"\235\303\365\247\270\323\060\207\134\133\160\335\214\113\330\160"
	"\212\333\322\330\136\007\271\373\107\016\022\252\055\136\042\174"
	"\116\256\277\026\100\237\322\361\222\314\046\210\364\242\321\161"
	"\111\103\147\316\120\163\162\242\023\356\256\164\102\150\360\133"
	"\152\005\200\202\350\270\273\336\314\164\146\161\001\323\006\316"
	"\041\070\045\256\270\022\145\371\161\074\374\366\244\246\221\322"
	"\222\126\342\051\207\312\252\241\366\342\171\341\172\340\174\355"
	"\215\135\106\106\211\272\242\220\323\031\321\121\144\336\221\167"
	"\057\234\344\363\014\025\336\275\135\101\130\052\271\044\262\242"
	"\077\130\011\366\336\117\242\257\172\044\272\120\307\125\263\361"
	"\103\015\173\313\007\231\055\061\021\070\242\271\345\260\216\171"
	"\034\260\007\004\261\207\035\162\202\355\041\025\063\304\030\333"
	"\040\364\054\216\366\047\113\151\144\242\303\132\040\037\200\241"
	"\004\337\363\222\270\175\260\107\003\220\325\273\357\162\172\257"
	"\272\346\202\072\360\174\267\103\042\126\324\102\376\157\044\015"
	"\140\045\052\324\136\176\017\167\036\151\357\074\320\155\246\225"
	"\241\352\101\265\066\145\043\103\373\164\372\151\030\226\161\346"
	"\057\052\334\146\276\315\210\305\154\177\264\343\342\127\263\065"
	"\067\104\202\026\372\321\107\036\310\005\115\067\023\114\074\053"
	"\213\153\122\275\124\277\155\062\162\057\075\330\251\107\015\156"
	"\360\154\203\316\051\162\012\164\105\116\135\151\255\124\320\341"
	"\063\217\020\313\000\020\373\202\003\023\007\275\000\376\236\004"
	"\173\045\152\134\242\377\116\260\213\173\320\365\215\327\326\063"
	"\217\243\366\005\122\270\203\051\003\365\077\023\102\255\016\061"
	"\042\133\356\344\135\067\033\224\244\176\237\307\056\066\154\073"
	"\200\152\133\305\067\021\061\127\346\251\157\342\160\125\200\340"
	"\371\216\201\215\250\110\371\202\337\150\013\102\242\043\153\111"
	"\036\256\026\014\030\261\045\251\013\270\204\320\375\215\010\375"
	"\155\215\140\305\351\063\352\163\012\372\225\260\172\361\263\331"
	"\234\127\340\277\316\354\063\172\017\072\213\326\304\034\033\120"
	"\364\104\355\313\006\305\253\071\036\046\230\047\157\122\113\021"
	"\053\201\371\212\032\132\003\177\120\001\216\135\356\234\001\371"
	"\233\326\074\205\254\167\037\241\057\012\355\251\236\175\054\074"
	"\271\367\266\112\043\076\000\023\045\316\165\374\202\176\145\377"
	"\260\020\312\054\154\123\145\117\243\334\245\335\130\355\240\273"
	"\005\312\255\037\170\243\304\116\024\302\020\136\000\241\134\115"
	"\073\370\355\151\177\105\314\034\156\152\241\135\107\103\003\073"
	"\302\161\333\231\151\010\062\337\240\073\176\250\101\360\305\066"
	"\223\333\000\346\035\236\125\360\362\162\214\166\252\057\302\137"
	"\116\352\000\325\313\353\072\363\261\032\131\300\132\270\065\374"
	"\245\114\143\221\133\073\215\301\215\066\306\120\213\221\120\043"
	"\334\260\004\254\353\212\303\324\311\354\137\060\203\365\362\024"
	"\003\004\265\151\046\270\154\103\004\351\304\243\052\124\021\157"
	"\362\032\251\353\317\023\242\306\020\344\051\132\236\034\231\217"
	"\274\041\356\120\372\160\042\052\074\122\113\343\072\374\215\047"
	"\032\154\151\351\253\372\236\117\306\111\217\301\007\303\120\062"
	"\176\125\216\376\052\026\140\126\106\100\136\234\262\377\226\251"
	"\056\300\061\134\222\266\034\333\244\113\173\112\233\055\012\042"
	"\267\332\127\152\251\321\274\172\144\201\310\352\033\046\133\055"
	"\066\243\075\363\031\313\025\100\273\046\256\207\141\161\244\351"
	"\230\121\326\371\102\260\257\240\112\234\337\163\044\111\035\100"
	"\041\000\134\146\325\351\042\114\155\024\334\303\205\055\251\160"
	"\053\266\313\040\154\076\264\263\150\304\006\245\365\254\032\334"
	"\256\337\211\126\274\164\277\073\220\215\007\220\161\366\063\274"
	"\003\213\023\066\072\045\314\066\156\275\147\323\170\056\044\226"
	"\316\241\036\360\153\120\064\334\022\202\344\314\273\067\271\221"
	"\025\204\221\113\352\072\310\200\200\012\341\334\142\065\350\000"
	"\137\133\050\026\271\275\000\001\142\171\117\010\077\332\275\161"
	"\031\012\077\250\065\137\313\302\103\121\211\002\116\271\134\326"
	"\365\223\023\106\361\133\217\203\072\154\071\347\111\135\043\121"
	"\020\166\165\104\075\166\023\026\213\312\321\376\055\362\035\375"
	"\202\234\047\204\135\162\102\231\350\215\144\265\205\247\374\157"
	"\341\060\170\323\070\100\174\107\165\313\005\167\025\006\200\030"
	"\250\250\043\304\266\157\113\222\004\361\270\122\327\155\304\213"
	"\366\165\060\234\234\301\337\055\245\301\125\106\143\367\124\140"
	"\355\363\013\060\004\272\106\372\256\335\047\346\263\334\324\222"
	"\302\344\206\271\231\112\012\006\107\170\345\214\342\112\057\156"
	"\115\366\233\273\046\350\022\115\047\001\222\207\337\045\132\107"
	"\011\076\334\036\160\010\175\107\156\017\230\000\343\061\234\351"
	"\052\120\277\055\021\347\161\144\225\244\230\360\233\322\262\030"
	"\036\265\353\253\064\121\073\244\166\247\133\350\373\112\376\071"
	"\325\041\312\145\171\130\374\035\220\170\225\327\240\113\176\001"
	"\364\154\253\221\257\205\030\252\213\363\216\231\161\275\304\024"
	"\003\360\063\101\200\154\174\010\264\170\276\127\277\305\031\214"
	"\270\047\156\172\222\156\227\046\375\140\016\362\363\061\323\366"
	"\066\004\124\362\215\364\000\223\037\235\305\150\325\127\140\263"
	"\010\370\032\270\137\047\022\300\006\242\353\242\276\077\361\264"
	"\031\311\107\327\357\166\362\223\257\274\044\170\247\233\311\064"
	"\364\354\347\130\305\017\206\272\151\176\137\370\376\162\216\211"
	"\030\000\044\302\146\022\244\326\314\114\327\311\225\135\040\073"
	"\265\076\116\031\005\040\300\145\225\255\076\025\046\316\373\034"
	"\214\310\240\313\335\305\210\326\224\355\203\261\254\067\067\166"
	"\254\147\356\241\034\147\264\067\214\247\076\213\373\116\215\062"
	"\152\204\123\111\165\015\134\141\142\073\126\143\242\217\137\016"
	"\376\221\143\161\344\255\116\043\271\125\123\110\325\110\034\037"
	"\047\334\266\374\024\232\163\043\276\267\100\004\236\131\022\044"
	"\054\276\102\160\162\264\053\344\332\316\347\010\031\034\076\214"
	"\372\246\317\073\011\360\256\260\002\007\377\301\032\165\172\235"
	"\017\373\006\370\060\037\327\252\172\203\161\034\171\143\213\315"
	"\056\056\136\052\022\121\345\141\202\106\255\304\035\070\372\203"
	"\226\015\267\124\365\236\362\235\147\161\066\003\027\304\173\355"
	"\222\357\004\021\301\364\156\225\244\007\277\326\311\220\355\347"
	"\316\162\052\057\360\221\274\111\325\322\071\116\235\034\226\165"
	"\210\055\110\277\135\236\210\174\057\266\227\332\044\134\342\225"
	"\330\341\015\354\240\116\113\053\300\133\360\324\256\163\336\104"
	"\134\074\022\047\136\141\241\337\370\271\076\274\076\353\134\154"
	"\026\136\122\233\105\072\342\337\333\033\171\275\133\141\200\262"
	"\315\054\223\074\264\042\365\362\101\073\377\100\007\110\134\176"
	"\226\316\306\313\373\327\110\125\260\174\136\361\026\041\220\076"
	"\064\242\024\234\201\070\026\051\215\141\164\105\054\104\101\171"
	"\303\213\003\301\260\256\020\215\077\323\223\006\031\010\110\103"
	"\370\215\224\161\346\303\226\126\253\167\212\303\003\311\350\173"
	"\263\141\217\276\247\150\333\373\314\306\017\046\061\030\255\130"
	"\307\122\336\013\220\050\326\356\315\364\005\172\132\205\335\354"
	"\211\164\327\340\373\051\070\354\077\132\071\366\165\146\001\114"
	"\076\062\034\027\244\325\141\053\272\333\322\054\332\174\230\051"
	"\150\143\006\100\071\133\125\024\000\244\011\064\224\332\016\201"
	"\263\032\005\076\142\003\032\100\047\031\116\043\243\102\275\004"
	"\201\341\057\341\024\264\015\302\074\260\034\350\374\250\150\367"
	"\116\323\355\060\262\365\031\231\313\141\026\010\335\246\246\351"
	"\305\105\045\074\327\134\336\204\220\254\330\251\250\124\201\156"
	"\162\046\345\047\376\105\170\004\105\204\001\067\170\033\067\154"
	"\143\067\301\201\135\042\053\145\337\042\125\160\234\143\355\033"
	"\054\170\016\321\227\024\047\014\007\273\021\034\271\074\117\327"
	"\361\247\324\173\217\122\314\116\272\172\047\156\054\372\004\001"
	"\270\173\030\321\204\144\305\246\115\000\027\355\332\151\111\116"
	"\345\207\312\067\257\300\272\306\261\267\031\364\113\351\105\321"
	"\211\223\245\217\376\330\220\360\312\261\247\323\246\077\111\253"
	"\136\300\231\246\114\344\272\333\302\005\017\156\173\300\227\234"
	"\215\300\122\063\020\061\300\375\022\017\204\164\261\211\254\365"
	"\321\262\310\366\126\030\321\076\342\342\341\163\323\021\107\313"
	"\341\155\156\356\262\126\330\051\266\243\004\064\320\350\052\106"
	"\125\141\342\272\366\161\174\137\241\120\122\104\140\377\040\260"
	"\107\221\204\260\142\330\106\001\200\303\254\315\351\306\153\161"
	"\307\170\227\361\072\372\141\220\265\244\144\253\357\222\125\263"
	"\044\065\307\246\017\274\123\164\222\337\023\061\370\220\132\325"
	"\372\307\176\335\243\230\370\315\373\171\160\060\071\057\267\067"
	"\103\334\275\012\221\060\337\316\252\137\010\376\331\260\106\207"
	"\053\071\124\047\257\112\207\011\072\332\335\001\025\026\012\125"
	"\062\373\076\235\247\153\335\261\031\230\137\310\235\377\062\163"
	"\102\035\265\332\307\313\374\252\237\270\305\354\203\212\340\123"
	"\376\377\363\217\037\130\002\136\240\141\111\134\061\276\111\351"
	"\232\274\063\307\264\232\240\065\251\046\310\271\116\250\000\131"
	"\332\366\343\005\301\135\232\175\371\022\234\147\121\320\367\343"
	"\122\367\305\303\005\264\150\345\266\153\062\052\076\047\100\225"
	"\241\244\144\242\032\076\371\207\306\366\220\176\261\207\063\075"
	"\373\252\070\071\056\036\300\260\150\346\111\140\252\155\202\142"
	"\226\152\246\227\201\320\370\000\274\307\270\216\234\052\225\245"
	"\000\256\220\125\352\006\322\274\337\314\320\131\107\240\331\216"
	"\222\330\121\242\073\155\311\244\070\042\331\270\202\141\207\362"
	"\252\216\176\324\343\203\235\255\156\046\225\224\255\237\151\322"
	"\036\046\226\227\012\023\114\011\273\074\216\176\333\136\162\261"
	"\316\333\114\251\366\053\211\115\030\166\044\175\021\244\327\067"
	"\317\250\316\157\131\012\347\072\004\311\335\161\301\331\045\023"
	"\062\076\043\362\152\302\031\363\217\261\171\021\233\033\135\013"
	"\077\367\232\025\055\077\022\144\113\271\144\105\001\377\351\364"
	"\127\161\046\311\355\323\330\316\155\043\171\246\002\030\370\220"
	"\160\017\332\275\045\334\270\016\101\317\032\362\243\174\372\206"
	"\042\247\320\303\146\127\052\373\152\345\330\173\231\235\115\264"
	"\103\055\112\117\316\342\025\070\334\137\046\021\040\244\253\270"
	"\214\172\356\073\143\317\353\344\225\304\060\077\231\316\351\346"
	"\076\334\223\357\250\326\117\272\271\261\350\207\317\201\254\110"
	"\163\170\346\244\164\237\337\115\363\134\114\036\275\137\326\242"
	"\261\265\023\026\371\046\262\150\212\361\177\365\022\162\300\225"
	"\375\174\174\305\171\354\017\025\307\345\004\307\165\373\023\162"
	"\225\133\017\127\042\311\114\027\257\265\327\316\156\034\173\176"
	"\166\022\035\053\162\325\224\207\166\253\320\362\264\144\254\153"
	"\267\110\145\315\360\007\066\207\317\325\211\250\112\175\223\075"
	"\147\315\232\007\236\312\056\122\117\205\245\104\375\014\330\246"
	"\174\312\221\066\265\256\202\006\311\265\220\161\176\020\341\162"
	"\117\326\267\053\015\204\025\165\125\370\300\106\365\163\332\176"
	"\110\143\274\221\017\257\224\132\046\117\143\076\003\302\147\075"
	"\014\041\247\146\263\313\121\206\047\220\134\026\202\137\152\326"
	"\113\203\215\101\352\235\344\160\060\174\304\135\300\373\113\177"
	"\073\374\065\054\222\200\210\163\135\170\165\066\347\005\077\237"
	"\102\102\302\016\323\144\377\244\311\222\271\021\105\036\076\375"
	"\225\262\045\027\032\134\156\021\054\173\334\121\025\056\157\262"
	"\314\376\307\162\120\155\040\122\270\244\310\363\315\375\141\252"
	"\171\047\030\104\376\335\070\324\300\372\164\037\204\145\357\166"
	"\146\226\057\351\306\203\364\010\367\261\250\003\214\272\144\240"
	"\074\001\130\004\356\167\065\143\352\014\363\127\165\307\101\173"
	"\264\003\176\247\015\040\274\177\351\070\014\144\071\206\053\273"
	"\377\073\215\206\165\010\063\210\037\244\211\022\376\150\013\215"
	"\356\016\062\076\027\040\163\270\124\233\235\267\311\377\313\273"
	"\350\173\245\050\072\371\264\215\223\216\206\257\163\063\011\217"
	"\151\034\132\142\332\345\174\212\006\351\022\002\171\223\247\127"
	"\071\237\225\135\375\350\342\167\122\227\050\012\132\045\244\115"
	"\066\323\342\041\104\374\031\373\311\227\230\325\151\151\266\005"
	"\204\162\227\137\201\231\226\156\377\117\251\372\347\244\353\305"
	"\256\174\011\262\157\362\051\354\243\300\074\370\306\240\032\100"
	"\272\341\117\333\075\012\042\042\353\061\076\304\164\224\224\102"
	"\056\304\235\151\301\003\024\113\155\351\127\323\212\044\371\060"
	"\253\056\052\373\112\216\371\311\047\256\270\031\136\074\111\140"
	"\335\020\140\046\252\154\121\110\355\266\252\312\226\034\126\037"
	"\216\314\071\272\027\107\135\266\112\140\147\111\012\223\126\027"
	"\152\065\310\024\111\220\064\155\177\076\357\325\064\260\210\244"
	"\133\233\263\166\274\054\130\323\111\264\011\361\351\154\324\107"
	"\071\153\161\107\107\126\330\212\303\056\226\254\100\330\305\212"
	"\123\140\373\252\034\034\103\360\014\103\354\277\215\271\240\074"
	"\120\151\176\254\074\275\046\105\075\031\106\151\153\374\341\343"
	"\255\033\314\204\251\325\117\122\122\373\340\121\202\175\340\203"
	"\345\111\027\136\066\031\120\133\137\076\106\275\142\201\123\125"
	"\202\141\143\156\134\173\311\350\177\013\031\221\327\001\263\032"
	"\350\223\114\124\300\016\101\321\034\032\177\346\174\104\316\051"
	"\362\047\204\215\336\252\334\262\102\056\000\245\362\057\340\325"
	"\023\013\220\344\076\221\302\331\207\064\021\310\145\104\047\301"
	"\010\260\317\360\212\256\244\170\176\003\302\257\362\353\243\102"
	"\107\040\133\101\126\003\170\263\227\016\115\170\311\356\073\037"
	"\076\056\216\125\370\341\265\243\367\351\255\345\036\320\141\260"
	"\262\252\374\012\361\121\067\161\265\317\041\270\016\021\043\260"
	"\315\350\135\301\203\207\001\021\367\315\350\011\372\257\356\041"
	"\201\313\265\256\111\354\312\052\321\267\360\251\121\375\306\131"
	"\314\276\212\237\155\305\116\012\256\244\317\122\323\046\071\224"
	"\067\012\064\274\141\222\021\133\352\346\200\253\133\107\305\354"
	"\247\066\263\335\036\122\113\253\124\326\004\073\335\013\025\304"
	"\006\306\336\372\070\243\335\031\217\314\334\136\117\132\034\014"
	"\320\002\361\202\363\337\164\076\117\062\044\236\143\135\226\111"
	"\347\207\223\165\056\160\217\275\074\153\033\214\306\070\231\226"
	"\072\212\031\055\152\215\154\271\300\221\127\043\356\356\155\326"
	"\165\000\114\243\160\333\141\255\107\174\071\015\265\322\243\357"
	"\134\275\035\306\112\211\200\012\032\330\056\011\306\233\340\074"
	"\233\054\337\013\007\101\271\117\276\362\134\163\305\000\143\042"
	"\275\200\351\007\012\151\022\044\101\100\056\007\333\016\103\167"
	"\073\043\203\103\144\074\222\042\057\356\226\364\357\371\026\254"
	"\172\377\264\204\151\306\251\253\006\327\262\342\346\366\131\041"
	"\032\334\144\177\031\366\242\110\345\070\075\324\062\123\200\254"
	"\123\065\060\275\373\331\150\002\261\033\345\227\021\077\270\054"
	"\034\035\253\065\023\116\176\371\206\273\315\271\017\116\145\142"
	"\203\226\040\177\157\210\201\041\243\147\270\265\246\161\341\302"
	"\217\215\370\243\333\166\234\142\061\151\033\101\267\201\244\072"
	"\027\304\272\207\114\073\250\360\243\141\245\111\323\207\014\142"
	"\024\005\005\360\173\242\122\255\013\156\356\303\357\222\376\007"
	"\126\270\216\243\364\067\223\227\231\071\341\154\300\356\317\325"
	"\363\325\305\156\167\030\034\203\207\013\106\167\235\104\176\364"
	"\374\015\230\360\104\053\207\335\145\151\112\045\127\031\373\112"
	"\357\300\271\147\331\326\352\140\341\060\330\176\165\126\163\161"
	"\144\013\142\250\067\352\206\235\123\321\303\253\353\276\365\332"
	"\176\257\101\130\205\053\271\146\134\221\345\322\350\131\104\114"
	"\145\246\365\235\221\173\072\345\115\375\220\070\273\206\022\072"
	"\065\124\223\273\200\114\042\335\336\007\257\306\141\363\022\306"
	"\232\010\144\053\204\236\020\321\234\241\011\130\047\033\222\135"
	"\157\046\030\360\162\073\315\120\103\174\027\244\160\052\153\012"
	"\062\317\066\266\155\107\207\012\350\220\142\020\254\365\155\034"
	"\033\206\014\215\301\331\336\004\126\366\251\306\040\024\321\123"
	"\343\007\011\121\116\221\133\067\042\275\107\317\262\264\353\316"
	"\073\370\133\375\322\072\001\050\061\253\357\121\277\300\245\243"
	"\307\256\364\025\100\120\114\142\016\224\061\301\110\035\217\204"
	"\025\353\201\347\045\203\020\127\056\377\251\356\277\116\221\206"
	"\375\205\234\075\326\351\240\344\175\321\245\306\357\064\113\005"
	"\037\314\354\105\117\375\234\176\374\106\154"
#define      tst2_z	19
#define      tst2	((&data[6636]))
	"\103\221\316\312\270\266\341\217\275\300\256\311\260\117\107\350"
	"\205\267\363\153\157\203\340\316\131"
#define      chk2_z	19
#define      chk2	((&data[6661]))
	"\110\101\305\374\040\120\042\153\302\306\061\263\223\041\106\047"
	"\137\305\015\370\306\343"
#define      pswd_z	256
#define      pswd	((&data[6693]))
	"\132\065\070\046\042\175\166\037\032\365\034\140\012\320\175\177"
	"\107\325\164\024\335\267\041\256\250\053\020\100\103\306\150\300"
	"\353\050\065\140\361\373\012\164\323\160\025\336\101\222\135\210"
	"\150\322\234\106\212\275\364\062\350\005\163\054\314\333\354\267"
	"\004\041\027\365\035\042\152\361\223\177\317\324\022\055\134\173"
	"\000\371\301\212\267\266\275\240\273\060\314\207\014\270\077\020"
	"\332\127\005\367\171\160\350\014\360\270\340\003\345\075\176\345"
	"\066\077\160\355\366\055\215\262\136\131\072\152\022\171\172\354"
	"\320\200\343\112\361\313\126\341\203\067\345\151\164\144\117\253"
	"\244\277\231\232\355\046\114\113\200\206\265\222\377\057\177\320"
	"\260\142\032\241\056\161\203\262\250\150\033\035\314\153\311\161"
	"\052\142\013\027\211\127\142\012\336\030\234\336\110\033\256\370"
	"\176\311\232\255\072\035\137\343\206\173\000\122\346\312\303\020"
	"\054\317\050\266\047\213\300\005\243\135\344\354\170\223\344\367"
	"\134\176\244\226\233\004\171\041\177\172\164\145\105\070\166\161"
	"\010\237\050\057\052\350\065\316\105\031\272\276\254\236\265\011"
	"\035\132\237\271\136\031\333\335\224\120\103\331\141\331\364\137"
	"\034\206"
#define      msg1_z	65
#define      msg1	((&data[6971]))
	"\074\307\304\173\017\005\136\036\065\167\170\153\257\237\216\054"
	"\302\141\323\014\362\302\352\036\117\115\341\155\211\360\364\027"
	"\020\177\124\132\141\141\131\312\062\224\316\126\046\156\355\177"
	"\345\216\004\240\347\264\137\044\260\262\226\165\025\045\213\377"
	"\214\102\263\362\217\016\212\056\250\212\132\011\163\070\040\310"
	"\011\026\255\107\013\312"
#define      msg2_z	19
#define      msg2	((&data[7043]))
	"\234\314\036\310\365\215\045\051\156\262\037\356\275\162\237\126"
	"\240\007\161\052\162\300\043\257"
#define      date_z	1
#define      date	((&data[7065]))
	"\117"
#define      tst1_z	22
#define      tst1	((&data[7067]))
	"\223\275\112\204\173\266\111\071\063\272\224\155\374\150\304\321"
	"\270\100\005\370\263\341\144\102\306"
#define      rlax_z	1
#define      rlax	((&data[7091]))
	"\333"
#define      shll_z	10
#define      shll	((&data[7094]))
	"\312\161\345\271\016\350\166\052\241\361\067\105\032\340"
#define      inlo_z	3
#define      inlo	((&data[7106]))
	"\012\333\065"
#define      lsto_z	1
#define      lsto	((&data[7109]))
	"\147"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
